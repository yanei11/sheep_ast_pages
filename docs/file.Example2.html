<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: Example2
  
    &mdash; Documentation by YARD 0.9.25
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" />

  <link rel="stylesheet" href="css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "Example2";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: Example2</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'>
<h1 id="label-sheep_ast+example2">sheep_ast example2</h1>

<p>This is the sheep_ast example2. This works as Quick start guide. The
example2 is at <code>./example/keyword_get/main.rb</code> from the root
directory of sheep_ast repository. The exampe2 application extracts certain
keyword from the cpp file. The application can execute by following.</p>

<pre class="code ruby"><code class="ruby">sheep_ast$ make example2</code></pre>

<p>Followings are the test file. It is cpp sntax code.</p>
<ul><li>
<p>spec/scoped_match_file/test2.cc</p>
</li></ul>

<h1 id="label-Source+Code">Source Code</h1>

<p>The example overall source code is following:</p>

<pre class="code ruby"><code class="ruby"><span class='comment'># typed: false
</span><span class='comment'># frozen_string_literal: true
</span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>./lib/analyzer_core</span><span class='tstring_end'>&#39;</span></span>
<span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>rainbow/refinement</span><span class='tstring_end'>&#39;</span></span>

<span class='id identifier rubyid_using'>using</span> <span class='const'>Rainbow</span>

<span class='id identifier rubyid_core'>core</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Sheep.html" title="Sheep (module)">Sheep</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Sheep/AnalyzerCore.html" title="Sheep::AnalyzerCore (class)">AnalyzerCore</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Sheep/AnalyzerCore.html#initialize-instance_method" title="Sheep::AnalyzerCore#initialize (method)">new</a></span></span>

<span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_config_tok'>config_tok</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_tok'>tok</span><span class='op'>|</span>
  <span class='id identifier rubyid_tok'>tok</span><span class='period'>.</span><span class='id identifier rubyid_add_token'>add_token</span> <span class='id identifier rubyid_tok'>tok</span><span class='period'>.</span><span class='id identifier rubyid_cmp'>cmp</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>include</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tok'>tok</span><span class='period'>.</span><span class='id identifier rubyid_add_token'>add_token</span> <span class='id identifier rubyid_tok'>tok</span><span class='period'>.</span><span class='id identifier rubyid_cmp'>cmp</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_config_ast'>config_ast</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>always.ignore</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__ast'>_ast</span><span class='comma'>,</span> <span class='id identifier rubyid_syn'>syn</span><span class='op'>|</span>
  <span class='id identifier rubyid_syn'>syn</span><span class='period'>.</span><span class='id identifier rubyid_within'>within</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ignore</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:na</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_space'>space</span><span class='comma'>,</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>//</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_config_ast'>config_ast</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>default.main</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__ast'>_ast</span><span class='comma'>,</span> <span class='id identifier rubyid_syn'>syn</span><span class='op'>|</span>
  <span class='id identifier rubyid_syn'>syn</span><span class='period'>.</span><span class='id identifier rubyid_within'>within</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>analyze</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:let</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:show</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>disable:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:debug</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#include</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:enc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>int</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:enc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>analyze</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:let</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:redirect</span><span class='comma'>,</span> <span class='symbol'>:test</span><span class='comma'>,</span> <span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>namespace:</span> <span class='symbol'>:_2</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:show</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>disable:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:debug</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>namespace</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:r</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:test</span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>analyze</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:let</span><span class='comma'>,</span>
        <span class='lbracket'>[</span><span class='symbol'>:record_kv_by_id</span><span class='comma'>,</span> <span class='symbol'>:ns_test_H</span><span class='comma'>,</span> <span class='symbol'>:_2</span><span class='comma'>,</span> <span class='symbol'>:_3</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>namespace:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='lbracket'>[</span><span class='symbol'>:show</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>disable:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='lbracket'>[</span><span class='symbol'>:debug</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>class</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:r</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_config_ast'>config_ast</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>always.ignore2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid__ast'>_ast</span><span class='comma'>,</span> <span class='id identifier rubyid_syn'>syn</span><span class='op'>|</span>
  <span class='id identifier rubyid_syn'>syn</span><span class='period'>.</span><span class='id identifier rubyid_within'>within</span> <span class='lbrace'>{</span>
    <span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ignore</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:na</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_crlf'>crlf</span><span class='comma'>,</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_lf'>lf</span><span class='comma'>,</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_eof'>eof</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
  <span class='rbrace'>}</span>
<span class='kw'>end</span>

<span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='lparen'>(</span><span class='label'>raise:</span> <span class='kw'>true</span><span class='rparen'>)</span> <span class='lbrace'>{</span>
  <span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_analyze_file'>analyze_file</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>spec/scoped_match_file/test2.cc</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='rbrace'>}</span>
<span class='id identifier rubyid_p'>p</span> <span class='id identifier rubyid_core'>core</span><span class='period'>.</span><span class='id identifier rubyid_data_store'>data_store</span><span class='period'>.</span><span class='id identifier rubyid_value'>value</span><span class='lparen'>(</span><span class='symbol'>:ns_test_H</span><span class='rparen'>)</span>
</code></pre>

<p>Explanation given in example1 is skipped.</p>

<h1 id="label-Chain+of+match+and+action">Chain of match and action</h1>

<p>You will see the following Ast registration have multiple
<code>E(...)</code>. The <code>_S</code> can have multiple
<code>E(...)</code>.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>int</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>main</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:enc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>(</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
</code></pre>

<p>For example this statement means that, target strings that has
&#39;int&#39;, nextly &#39;main&#39;, nextly enclosed block from
&#39;(&#39; to &#39;)&#39;, and such strings should be passed to the
<code>:let</code> action. The action calls data to <code>:redirect</code>,
<code>show</code>, and <code>debug</code> functions.</p>

<h1 id="label-Tag+symbol">Tag symbol</h1>

<p>The following syntax has <code>_2</code> or <code>_3</code>. It is called
tag symbol. It means which matched expression will be used in the action.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>analyze</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:let</span><span class='comma'>,</span>
        <span class='lbracket'>[</span><span class='symbol'>:record_kv_by_id</span><span class='comma'>,</span> <span class='symbol'>:ns_test_H</span><span class='comma'>,</span> <span class='symbol'>:_2</span><span class='comma'>,</span> <span class='symbol'>:_3</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>namespace:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='lbracket'>[</span><span class='symbol'>:show</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>disable:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='lbracket'>[</span><span class='symbol'>:debug</span><span class='rbracket'>]</span><span class='rparen'>)</span>
      <span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>class</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:r</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
</code></pre>

<p>The symbol <code>_2</code> and <code>_3</code> are used for the function
<code>:record_kv_by_id</code>. It stores key, value pair which are
specified tag <code>_2</code>, <code>_3</code> and it stores to
<code>ns_test_H</code> specified hash in the datastore object. The tags are
corresonds to matched expression of <code>E(:e, &#39;class&#39;)</code> and
<code>E(:r, &#39;.*&#39;)</code>. The tags are given by framework. But the
tag also can be specified manually like <code>E(:sc, &#39;{&#39;,
&#39;}&#39;, :test)</code>.</p>

<h1 id="label-Let+and+redirect+function">Let and redirect function</h1>

<p>Let object has function to pass data to multiple functions defined inside
Let object. Following syntax&#39;s Let calls <code>:redirect</code>
function, and it is important function in the sheep_ast framework.</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_register_syntax'>register_syntax</span><span class='lparen'>(</span>
      <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>analyze</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
      <span class='const'>A</span><span class='lparen'>(</span><span class='symbol'>:let</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:redirect</span><span class='comma'>,</span> <span class='symbol'>:test</span><span class='comma'>,</span> <span class='int'>1</span><span class='op'>..</span><span class='op'>-</span><span class='int'>2</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>namespace:</span> <span class='symbol'>:_2</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:show</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='label'>disable:</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='symbol'>:debug</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='rparen'>)</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid__SS'>_SS</span><span class='lparen'>(</span>
        <span class='id identifier rubyid__S'>_S</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:e</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>namespace</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:r</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>.*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&lt;&lt;</span> <span class='const'>E</span><span class='lparen'>(</span><span class='symbol'>:sc</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>{</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>}</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:test</span><span class='rparen'>)</span>
      <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
</code></pre>

<p>The redirect function make specified data to re-input Ast stages, but it
can specify which Ast should process also it can put namespace by tag
symbol. Please see redirect yard document or <code>spec/</code> test case
more detailed. The above syntax matches like: <code> namespace example { 
someprocess();  someprocess2(); } </code></p>

<p>And redirect function put namespace expression matched <code>E(:r,
&#39;.*&#39;)</code>at tag <code>_2</code>, and redirect data specified by
:test symbol and range 1..-2 to Ast stages again. In this case, redirect
data will be <code>\n  someprocess();\n  someprocess2();\n</code>, and
namespace will be <code>example</code> <code>:redirect</code> function has
options <code>ast_include</code> and <code>ast_exclude</code> and they can
use to specify which Ast can use to process of redirected data. If you
execute this example, you can see the result data has namespace.</p>

<h1 id="label-crlf-2C+lf">crlf, lf</h1>

<p>The last syntax registration has crlf, lf, eof handling. It prevents
NotFound exception by those input.</p>

<h1 id="label-eof+validation">eof validation</h1>

<p>sheep_ast input special expression <code><em>sheep_eof</em></code>. It is
input after end of process of given file. The eof will never be input in
case that core get expression by like <code>core &lt;&lt;
&#39;abc&#39;</code> (sheep_ast has interface to feed just string as well
as input by file path. Please see spec/ testcases) The eof has important
role. It kicks eof validation. eof validationn is to validate Ast process
is finished at the eof. sheep_ast raise error when Ast process is in
progress at the timing eof is input. User can detect bug by this
validation. If user wants to use the validatoin in the way of inputing
string, user should do like &#39;core &lt;&lt; &#39;abc&#39; &lt;&lt;
<code><em>sheep_eof</em></code></p>

<h1 id="label-Summary">Summary</h1>

<p>In this example, sheep_ast capability to handle how matched expression is
handled by tag symbol. It is also explaind how matched symbol is
re-estimated by Let object and redirect function.</p>
</div></div>

      <div id="footer">
  Generated on Fri Dec 11 05:03:38 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.4.1).
</div>

    </div>
  </body>
</html>